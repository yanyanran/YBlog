## HTTPS握手过程

1、客户端发起HTTPS连接。浏览器去DNS服务器获取此url对应的ip，然后客户端连接上服务端的443端口，发送请求到服务端，此时客户端将自己支持的加密算法也带给服务端；

2、服务端收到这套加密算法，和自己支持的加密算法对比（也就是和自己的私钥进行对比），不符合就断开连接；如果符合，服务端就将SSL证书发送给客户端。

> 证书中包括：证书颁发机构；使用机构；公钥；有效期；签名算法；指纹算法；指纹。

这里服务端发送的东西是用**私钥**加密的，**公钥都能解开**，并不能保证发送的数据包不被别人看到，所以后面的过程会和客户端商量选择一个对称加密。

3、客户端**验证发来的证书**。验证证书无误后会**生成一个随机数**，**用服务端公钥加密**（*如此一来，此随机数只有服务端的私钥才能解开了*）接着客户端生成握手信息，用证书中的签名hash算法获取**握手信息的hash值**（*为保证传回到服务端的握手信息没被篡改*），然后用生成的随机数将[握手信息和握手信息的hash值]进行加密，然后连着前面用公钥加密过的随机数，一起发送给服务端。

4、服务端接收随机数加密的信息，用**私钥解密得到随机数**，再用随机数解密握手信息，获取握手信息和握手信息的hash值，计算自己发送的握手信息的hash值，与客户端传回来的进行对比验证握手信息是否被篡改。

验证无误，同样使用随机字符串加密握手信息和握手信息hash值发回给客户端

5、客户端收到后，用刚开始自己生成的随机数解密，验证被随机数加密的握手信息和握手信息hash值。

验证无误后，握手过程就完成了，从此服务端和客户端就开始用那串随机数进行对称加密通信了（常用的对称加密算法有AES）。